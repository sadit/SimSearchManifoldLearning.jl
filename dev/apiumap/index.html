<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>UMAP · SimSearchManifoldLearning.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://sadit.github.io/SimSearchManifoldLearning.jl/apiumap/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SimSearchManifoldLearning.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>UMAP</a><ul class="internal"><li><a class="tocitem" href="#UMAP"><span>UMAP</span></a></li></ul></li><li><a class="tocitem" href="../apiml/">API ManifoldLearning</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>UMAP</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>UMAP</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/main/docs/src/apiumap.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="UMAP"><a class="docs-heading-anchor" href="#UMAP">UMAP</a><a id="UMAP-1"></a><a class="docs-heading-anchor-permalink" href="#UMAP" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.UMAP" href="#SimSearchManifoldLearning.UMAP"><code>SimSearchManifoldLearning.UMAP</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct UMAP</code></pre><p>The UMAP model struct</p><p><strong>Properties</strong></p><ul><li><code>graph</code>: The fuzzy simplicial set that represents the all knn graph</li><li><code>embedding</code>: The embedding projection </li><li><code>k</code> the number of neighbors used to create the model</li><li><code>a</code> and <code>b</code>: parameters to ensure an well distributed and smooth projection (from <code>min_dist</code> and <code>spread</code> arguments in <code>fit</code>)</li><li><code>index</code>: the search index, it can be nothing if the model is handled directly with precomputed <code>knns</code> and <code>dists</code> matrices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/umap_.jl#LL6-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsAPI.fit" href="#StatsAPI.fit"><code>StatsAPI.fit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit(Type{UMAP}, knns, dists; &lt;kwargs&gt;) -&gt; UMAP object</code></pre><p>Create a model representing the embedding of data <code>(X, dist)</code> into <code>maxoutdim</code>-dimensional space. Note that <code>knns</code> and <code>dists</code> jointly specify the all <code>k</code> nearest neighbors of <span>$(X, dist)$</span>, these results must not include self-references. See the <code>allknn</code> method in <code>SimilaritySearch</code>.</p><p><strong>Arguments</strong></p><ul><li><code>knns</code>: A <span>$(k, n)$</span> matrix of integers (identifiers).</li><li><code>dists</code>: A <span>$(k, n)$</span> matrix of floating points (distances).</li></ul><p>It uses all available threads for the projection.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>maxoutdim::Integer=2</code>: The number of components in the embedding</li><li><code>n_epochs::Integer = 300</code>: the number of training epochs for embedding optimization</li><li><code>learning_rate::Real = 1</code>: the initial learning rate during optimization</li><li><code>learning_rate_decay::Real = 0.9</code>: how much <code>learning_rate</code> is updated on each epoch <code>(learning_rate *= learning_rate_decay)</code> (a minimum value is also considered as 1e-6)</li><li><code>layout::AbstractLayout = SpectralLayout()</code>: how to initialize the output embedding</li><li><code>min_dist::Real = 0.1</code>: the minimum spacing of points in the output embedding</li><li><code>spread::Real = 1</code>: the effective scale of embedded points. Determines how clustered embedded points are in combination with <code>min_dist</code>.</li><li><code>set_operation_ratio::Real = 1</code>: interpolates between fuzzy set union and fuzzy set intersection when constructing the UMAP graph (global fuzzy simplicial set). The value of this parameter should be between 1.0 and 0.0: 1.0 indicates pure fuzzy union, while 0.0 indicates pure fuzzy intersection.</li><li><code>local_connectivity::Integer = 1</code>: the number of nearest neighbors that should be assumed to be locally connected. The higher this value, the more connected the manifold becomes. This should not be set higher than the intrinsic dimension of the manifold.</li><li><code>repulsion_strength::Real = 1</code>: the weighting of negative samples during the optimization process.</li><li><code>neg_sample_rate::Integer = 5</code>: the number of negative samples to select for each positive sample. Higher values will increase computational cost but result in slightly more accuracy.</li><li><code>tol::Real = 1e-4</code>: tolerance to early stopping while optimizing embeddings.</li><li><code>minbatch=0</code>: controls how parallel computation is made, zero to use <code>SimilaritySearch</code> defaults and -1 to avoid parallel computation; passed to <code>@batch</code> macro of <code>Polyester</code> package.</li><li><code>a = nothing</code>: this controls the embedding. By default, this is determined automatically by <code>min_dist</code> and <code>spread</code>.</li><li><code>b = nothing</code>: this controls the embedding. By default, this is determined automatically by <code>min_dist</code> and <code>spread</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/umap_.jl#LL31-L62">source</a></section><section><div><pre><code class="nohighlight hljs">fit(::Type{&lt;:UMAP}, index_or_data;
    k=15,
    dist::SemiMetric=L2Distance,
    minbatch=0,
    kwargs...)</code></pre><p>Wrapper for <code>fit</code> that computes <code>n_nearests</code> nearest neighbors on <code>index_or_data</code> and passes these and <code>kwargs</code> to regular <code>fit</code>.</p><p><strong>Arguments</strong></p><ul><li><code>index_or_data</code>: an already constructed index (see <code>SimilaritySearch</code>), a matrix, or an abstact database (<code>SimilaritySearch</code>)</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>k=15</code>: number of neighbors to compute</li><li><code>dist=L2Distance()</code>: A distance function (see <code>Distances.jl</code>)</li><li><code>minbatch=0</code>: controls how parallel computation is made, zero to use <code>SimilaritySearch</code> defaults and -1 to avoid parallel computation; passed to <code>@batch</code> macro of <code>Polyester</code> package.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/umap_.jl#LL117-L134">source</a></section><section><div><pre><code class="nohighlight hljs">fit(UMAP::UMAP, maxoutdim; &lt;kwargs&gt;)</code></pre><p>Reuses a previously computed model with a different number of components</p><p><strong>Keyword arguments</strong></p><ul><li><code>n_epochs=50</code>: number of epochs to run</li><li><code>learning_rate::Real = 1f0</code>: initial learning rate</li><li><code>learning_rate_decay::Real = 0.9f0</code>: how learning rate is adjusted per epoch <code>learning_rate *= learning_rate_decay</code></li><li><code>repulsion_strength::Float32 = 1f0</code>: repulsion force (for negative sampling)</li><li><code>neg_sample_rate::Integer = 5</code>: how many negative examples per object are used.</li><li><code>tol::Real = 1e-4</code>: tolerance to early stopping while optimizing embeddings.</li><li><code>minbatch=0</code>: controls how parallel computation is made. See <a href="@ref"><code>SimilaritySearch.getminbatch</code></a> and <code>@batch</code> (<code>Polyester</code> package).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/umap_.jl#LL186-L200">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsAPI.predict" href="#StatsAPI.predict"><code>StatsAPI.predict</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">predict(model::UMAP)</code></pre><p>Returns the internal embedding (the entire dataset projection)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/umap_.jl#LL229-L233">source</a></section><section><div><pre><code class="nohighlight hljs">predict(model::UMAP, Q::AbstractDatabase; k::Integer=15, kwargs...)
predict(model::UMAP, knns, dists; &lt;kwargs&gt;) -&gt; embedding</code></pre><p>Use the given model to embed new points <span>$Q$</span> into an existing embedding produced by <span>$(X, dist)$</span>. The second function represent <code>Q</code> using its <code>k</code> nearest neighbors in <code>X</code> under some distance function (<code>knns</code> and <code>dists</code>) See <code>searchbatch</code> in <code>SimilaritySearch</code> to compute both (also for <code>AbstractDatabase</code> objects).</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: The fitted model</li><li><code>knns</code>: matrix of identifiers (integers) of size <span>$(k, |Q|)$</span></li><li><code>dists</code>: matrix of distances (floating point values) of size <span>$(k, |Q|)$</span></li></ul><p>Note: the number of neighbors <code>k</code> (embedded into knn matrices) control the embedding. Larger values capture more global structure in the data, while small values capture more local structure.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>n_epochs::Integer = 30</code>: the number of training epochs for embedding optimization</li><li><code>learning_rate::Real = 1</code>: the initial learning rate during optimization</li><li><code>learning_rate_decay::Real = 0.8</code>: A decay factor for the <code>learning_rate</code> param (on each epoch)</li><li><code>set_operation_ratio::Real = 1</code>: interpolates between fuzzy set union and fuzzy set intersection when constructing the UMAP graph (global fuzzy simplicial set). The value of this parameter should be between 1.0 and 0.0: 1.0 indicates pure fuzzy union, while 0.0 indicates pure fuzzy intersection.</li><li><code>local_connectivity::Integer = 1</code>: the number of nearest neighbors that should be assumed to be locally connected. The higher this value, the more connected the manifold becomes. This should not be set higher than the intrinsic dimension of the manifold.</li><li><code>repulsion_strength::Real = 1</code>: the weighting of negative samples during the optimization process.</li><li><code>neg_sample_rate::Integer = 5</code>: the number of negative samples to select for each positive sample. Higher values will increase computational cost but result in slightly more accuracy.</li><li><code>tol::Real = 1e-4</code>: tolerance to early stopping while optimizing embeddings.</li><li><code>minbatch=0</code>: controls how parallel computation is made. See <a href="@ref"><code>SimilaritySearch.getminbatch</code></a> and <code>@batch</code> (<code>Polyester</code> package).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/umap_.jl#LL236-L262">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>optimize_embeddings!</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Layouts"><a class="docs-heading-anchor" href="#Layouts">Layouts</a><a id="Layouts-1"></a><a class="docs-heading-anchor-permalink" href="#Layouts" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.RandomLayout" href="#SimSearchManifoldLearning.RandomLayout"><code>SimSearchManifoldLearning.RandomLayout</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RandomLayout &lt;: AbstractLayout</code></pre><p>Initializes the embedding using a random set of points. It may converge slowly</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/layouts.jl#LL12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.SpectralLayout" href="#SimSearchManifoldLearning.SpectralLayout"><code>SimSearchManifoldLearning.SpectralLayout</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpectralLayout &lt;: AbstractLayout</code></pre><p>Initializes the embedding using the spectral layout method. It could be costly in very large datasets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/layouts.jl#LL5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.PrecomputedLayout" href="#SimSearchManifoldLearning.PrecomputedLayout"><code>SimSearchManifoldLearning.PrecomputedLayout</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PrecomputedLayout &lt;: AbstractLayout</code></pre><p>Initializes the embedding using a previously computed layout, i.e., (maxoutdim, n_points) matrix. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/layouts.jl#LL19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.KnnGraphLayout" href="#SimSearchManifoldLearning.KnnGraphLayout"><code>SimSearchManifoldLearning.KnnGraphLayout</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">KnnGraphLayout &lt;: AbstractLayout</code></pre><p>A lattice like + clouds of points initialization that uses the computed all-knn graph. This layout initialization is a simple proof of concept, so please use it under this assumption.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/layouts.jl#LL28-L34">source</a></section></article><h3 id="Precomputed-Knn-matrices"><a class="docs-heading-anchor" href="#Precomputed-Knn-matrices">Precomputed Knn matrices</a><a id="Precomputed-Knn-matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Precomputed-Knn-matrices" title="Permalink"></a></h3><p>If you don&#39;t want to use <code>SimilaritySearch</code> for solving <code>k</code> nearest neighbors, you can also pass precomputed knns and distances matrices.</p><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.PrecomputedKnns" href="#SimSearchManifoldLearning.PrecomputedKnns"><code>SimSearchManifoldLearning.PrecomputedKnns</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct PrecomputedKnns &lt;: AbstractSearchContext
    knns
    dists
end</code></pre><p>An index-like wrapper for precomputed all-knns (as knns and dists matrices (k, n))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/precomputedknns.jl#LL24-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimSearchManifoldLearning.PrecomputedAffinityMatrix" href="#SimSearchManifoldLearning.PrecomputedAffinityMatrix"><code>SimSearchManifoldLearning.PrecomputedAffinityMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct PrecomputedAffinityMatrix &lt;: AbstractSearchContext
    dists # precomputed distances for all pairs (squared matrix)
end</code></pre><p>An index-like wrapper for precomputed affinity matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimSearchManifoldLearning.jl/blob/8d8f0be9297f9d641f2ec757d143813532d258f7/src/precomputedknns.jl#LL4-L10">source</a></section></article><h3 id="Distance-functions"><a class="docs-heading-anchor" href="#Distance-functions">Distance functions</a><a id="Distance-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Distance-functions" title="Permalink"></a></h3><p>The distance functions are defined to work under the <code>evaluate(::SemiMetric, u, v)</code> function (borrowed from <a href="https://github.com/JuliaStats/Distances.jl">Distances.jl</a> package).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../apiml/">API ManifoldLearning »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Thursday 16 June 2022 18:34">Thursday 16 June 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
